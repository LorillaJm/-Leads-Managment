# ğŸ—ï¸ Admin User Management - Architecture Diagram

## System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT BROWSER                               â”‚
â”‚                     http://localhost:5173                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â”‚ HTTP/HTTPS
                                  â”‚ JWT Bearer Token
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FRONTEND (React + Vite)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   Users.tsx  â”‚  â”‚ CreateUser   â”‚  â”‚  EditUser    â”‚             â”‚
â”‚  â”‚   (Page)     â”‚  â”‚  Dialog      â”‚  â”‚  Dialog      â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚         â”‚                  â”‚                  â”‚                      â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                            â”‚                                         â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚                  â”‚   TanStack Query  â”‚                              â”‚
â”‚                  â”‚   (Data Fetching) â”‚                              â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                            â”‚                                         â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚                  â”‚    API Client     â”‚                              â”‚
â”‚                  â”‚   (api.ts)        â”‚                              â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ REST API Calls
                             â”‚ Authorization: Bearer <token>
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND API (Express + TypeScript)                â”‚
â”‚                       http://localhost:3001                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    MIDDLEWARE LAYER                           â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  â€¢ Helmet (Security Headers)                                 â”‚  â”‚
â”‚  â”‚  â€¢ CORS (Cross-Origin)                                       â”‚  â”‚
â”‚  â”‚  â€¢ Rate Limiter (10 req/15min on sensitive ops)             â”‚  â”‚
â”‚  â”‚  â€¢ Body Parser (JSON)                                        â”‚  â”‚
â”‚  â”‚  â€¢ Cookie Parser (Refresh Tokens)                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    ROUTES LAYER                              â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  GET    /api/v1/users              [ADMIN]                   â”‚  â”‚
â”‚  â”‚  POST   /api/v1/users              [ADMIN]                   â”‚  â”‚
â”‚  â”‚  PATCH  /api/v1/users/:id          [ADMIN]                   â”‚  â”‚
â”‚  â”‚  POST   /api/v1/users/:id/reset-password [ADMIN]            â”‚  â”‚
â”‚  â”‚  PATCH  /api/v1/users/:id/status   [ADMIN]                   â”‚  â”‚
â”‚  â”‚  GET    /api/v1/users/sales-consultants [ALL]               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                 AUTHENTICATION MIDDLEWARE                     â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  â€¢ authenticate() - Verify JWT token                         â”‚  â”‚
â”‚  â”‚  â€¢ requireRole() - Check user role (ADMIN/SC)               â”‚  â”‚
â”‚  â”‚  â€¢ Check user status (ACTIVE/DISABLED)                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                   CONTROLLER LAYER                            â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  UserController                                              â”‚  â”‚
â”‚  â”‚  â€¢ getAllUsers()                                             â”‚  â”‚
â”‚  â”‚  â€¢ createUser()                                              â”‚  â”‚
â”‚  â”‚  â€¢ updateUser()                                              â”‚  â”‚
â”‚  â”‚  â€¢ resetPassword()                                           â”‚  â”‚
â”‚  â”‚  â€¢ updateStatus()                                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                   VALIDATION LAYER                            â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  Zod Schemas:                                                â”‚  â”‚
â”‚  â”‚  â€¢ createUserSchema                                          â”‚  â”‚
â”‚  â”‚  â€¢ updateUserSchema                                          â”‚  â”‚
â”‚  â”‚  â€¢ resetPasswordSchema                                       â”‚  â”‚
â”‚  â”‚  â€¢ userFiltersSchema                                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    SERVICE LAYER                              â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  UserService                                                 â”‚  â”‚
â”‚  â”‚  â€¢ getAllUsers(filters) - Pagination + Search                â”‚  â”‚
â”‚  â”‚  â€¢ createUser(data) - Hash password + Create                 â”‚  â”‚
â”‚  â”‚  â€¢ updateUser(id, data) - Update fields                      â”‚  â”‚
â”‚  â”‚  â€¢ resetUserPassword(id, pwd) - Hash + Force change          â”‚  â”‚
â”‚  â”‚  â€¢ updateUserStatus(id, status) - Enable/Disable             â”‚  â”‚
â”‚  â”‚  â€¢ getSalesConsultants() - Get active SCs                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ï¿½ï¿½â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    SECURITY LAYER                             â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  â€¢ bcrypt.hash() - 12 rounds                                 â”‚  â”‚
â”‚  â”‚  â€¢ bcrypt.compare() - Verify passwords                       â”‚  â”‚
â”‚  â”‚  â€¢ jwt.sign() - Generate tokens                              â”‚  â”‚
â”‚  â”‚  â€¢ jwt.verify() - Validate tokens                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                             â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                      ORM LAYER                                â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  Prisma Client                                               â”‚  â”‚
â”‚  â”‚  â€¢ prisma.user.findMany()                                    â”‚  â”‚
â”‚  â”‚  â€¢ prisma.user.create()                                      â”‚  â”‚
â”‚  â”‚  â€¢ prisma.user.update()                                      â”‚  â”‚
â”‚  â”‚  â€¢ prisma.user.findUnique()                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ SQL Queries
                             â”‚ (Parameterized - SQL Injection Safe)
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DATABASE (PostgreSQL)                             â”‚
â”‚                    postgresql://localhost:5432                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                      users TABLE                              â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  id                  String (CUID)    PRIMARY KEY            â”‚  â”‚
â”‚  â”‚  email               String           UNIQUE, INDEXED        â”‚  â”‚
â”‚  â”‚  passwordHash        String           (bcrypt hashed)        â”‚  â”‚
â”‚  â”‚  fullName            String                                  â”‚  â”‚
â”‚  â”‚  position            String?                                 â”‚  â”‚
â”‚  â”‚  role                String           INDEXED (ADMIN/SC)     â”‚  â”‚
â”‚  â”‚  photoUrl            String?                                 â”‚  â”‚
â”‚  â”‚  status              String           INDEXED (ACTIVE/...)   â”‚  â”‚
â”‚  â”‚  forcePasswordChange Boolean          DEFAULT true           â”‚  â”‚
â”‚  â”‚  lastLoginAt         DateTime?                               â”‚  â”‚
â”‚  â”‚  createdAt           DateTime         DEFAULT now()          â”‚  â”‚
â”‚  â”‚  updatedAt           DateTime         AUTO UPDATE            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                      â”‚
â”‚  Indexes:                                                            â”‚
â”‚  â€¢ users_email_idx (email)                                          â”‚
â”‚  â€¢ users_role_idx (role)                                            â”‚
â”‚  â€¢ users_status_idx (status)                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Diagrams

### 1. Create User Flow

```
Admin User (Browser)
       â”‚
       â”‚ 1. Click "Create User"
       â–¼
CreateUserDialog
       â”‚
       â”‚ 2. Fill form + Submit
       â–¼
React Hook Form + Zod
       â”‚
       â”‚ 3. Validate input
       â–¼
TanStack Mutation
       â”‚
       â”‚ 4. POST /api/v1/users
       â”‚    { email, fullName, position, role, temporaryPassword }
       â–¼
API Server (Express)
       â”‚
       â”‚ 5. authenticate() middleware
       â”‚    - Verify JWT token
       â”‚    - Check user status
       â–¼
       â”‚ 6. requireRole(ADMIN) middleware
       â”‚    - Verify user is ADMIN
       â–¼
UserController.createUser()
       â”‚
       â”‚ 7. Validate with createUserSchema
       â–¼
UserService.createUser()
       â”‚
       â”‚ 8. Check email not exists
       â”‚ 9. Hash password (bcrypt, 12 rounds)
       â”‚ 10. Create user record
       â–¼
Prisma Client
       â”‚
       â”‚ 11. INSERT INTO users (...)
       â–¼
PostgreSQL Database
       â”‚
       â”‚ 12. Return created user
       â–¼
Response to Client
       â”‚
       â”‚ 13. { success: true, data: { user } }
       â–¼
TanStack Query
       â”‚
       â”‚ 14. Invalidate cache
       â”‚ 15. Refetch users list
       â–¼
UI Updates
       â”‚
       â”‚ 16. Show success toast
       â”‚ 17. Close dialog
       â”‚ 18. New user appears in table
       â–¼
Admin sees new user âœ…
```

### 2. Reset Password Flow

```
Admin User
       â”‚
       â”‚ 1. Click â‹¯ â†’ "Reset Password"
       â–¼
ResetPasswordDialog
       â”‚
       â”‚ 2. Generate/Enter password
       â”‚ 3. Copy to clipboard
       â”‚ 4. Submit
       â–¼
API: POST /users/:id/reset-password
       â”‚
       â”‚ 5. Authenticate + Authorize (ADMIN)
       â–¼
UserService.resetUserPassword()
       â”‚
       â”‚ 6. Hash new password (bcrypt)
       â”‚ 7. Update user:
       â”‚    - passwordHash = new hash
       â”‚    - forcePasswordChange = true
       â–¼
Database Updated
       â”‚
       â”‚ 8. User must change password on next login
       â–¼
Success Response
       â”‚
       â”‚ 9. Show success toast
       â”‚ 10. Close dialog
       â–¼
Admin shares password with user âœ…
```

### 3. Disable User Flow

```
Admin User
       â”‚
       â”‚ 1. Click â‹¯ â†’ "Disable User"
       â–¼
API: PATCH /users/:id/status
       â”‚
       â”‚ 2. { status: "DISABLED" }
       â–¼
UserService.updateUserStatus()
       â”‚
       â”‚ 3. Check not disabling self
       â”‚ 4. Update user status
       â–¼
Database Updated
       â”‚
       â”‚ 5. User status = DISABLED
       â–¼
Next Login Attempt by Disabled User
       â”‚
       â”‚ 6. POST /auth/login
       â–¼
AuthService.login()
       â”‚
       â”‚ 7. Check user.status
       â”‚ 8. status === DISABLED
       â–¼
Error: "Account has been disabled" (403)
       â”‚
       â”‚ 9. User cannot login âœ…
       â–¼
Admin successfully disabled user âœ…
```

## Security Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SECURITY LAYERS                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  Layer 1: Network Security                                  â”‚
â”‚  â”œâ”€ HTTPS (Production)                                      â”‚
â”‚  â”œâ”€ CORS (Whitelist origins)                                â”‚
â”‚  â””â”€ Helmet (Security headers)                               â”‚
â”‚                                                              â”‚
â”‚  Layer 2: Authentication                                    â”‚
â”‚  â”œâ”€ JWT Access Token (15 min expiry)                        â”‚
â”‚  â”œâ”€ JWT Refresh Token (7 day expiry)                        â”‚
â”‚  â”œâ”€ HTTP-Only Cookies (Refresh token)                       â”‚
â”‚  â””â”€ Token verification on every request                     â”‚
â”‚                                                              â”‚
â”‚  Layer 3: Authorization (RBAC)                              â”‚
â”‚  â”œâ”€ Role-based access control                               â”‚
â”‚  â”œâ”€ Admin-only endpoints                                    â”‚
â”‚  â”œâ”€ User status check (ACTIVE/DISABLED)                     â”‚
â”‚  â””â”€ Backend enforcement (never trust client)                â”‚
â”‚                                                              â”‚
â”‚  Layer 4: Input Validation                                  â”‚
â”‚  â”œâ”€ Zod schemas on all inputs                               â”‚
â”‚  â”œâ”€ Email format validation                                 â”‚
â”‚  â”œâ”€ Password strength requirements                          â”‚
â”‚  â””â”€ SQL injection prevention (Prisma ORM)                   â”‚
â”‚                                                              â”‚
â”‚  Layer 5: Password Security                                 â”‚
â”‚  â”œâ”€ bcrypt hashing (12 rounds)                              â”‚
â”‚  â”œâ”€ Never store plain text passwords                        â”‚
â”‚  â”œâ”€ Never return passwords in responses                     â”‚
â”‚  â””â”€ Force password change on first login                    â”‚
â”‚                                                              â”‚
â”‚  Layer 6: Rate Limiting                                     â”‚
â”‚  â”œâ”€ 10 requests per 15 minutes (sensitive ops)              â”‚
â”‚  â”œâ”€ Prevents brute force attacks                            â”‚
â”‚  â””â”€ Per-IP tracking                                         â”‚
â”‚                                                              â”‚
â”‚  Layer 7: Audit & Monitoring                                â”‚
â”‚  â”œâ”€ Audit log table (ready)                                 â”‚
â”‚  â”œâ”€ Last login tracking                                     â”‚
â”‚  â”œâ”€ Error logging service                                   â”‚
â”‚  â””â”€ Request logging (development)                           â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Hierarchy

```
App.tsx
  â””â”€ AuthProvider
      â””â”€ Routes
          â””â”€ ProtectedRoute
              â””â”€ Layout
                  â”œâ”€ Sidebar (with role-based nav)
                  â”œâ”€ TopBar
                  â””â”€ Main Content
                      â””â”€ Users.tsx
                          â”œâ”€ Header (title + Create button)
                          â”œâ”€ Filters Card
                          â”‚   â”œâ”€ Search Input
                          â”‚   â”œâ”€ Role Select
                          â”‚   â””â”€ Status Select
                          â”œâ”€ Table Card
                          â”‚   â”œâ”€ TanStack Table
                          â”‚   â”‚   â”œâ”€ TableHeader
                          â”‚   â”‚   â””â”€ TableBody
                          â”‚   â”‚       â””â”€ TableRow (per user)
                          â”‚   â”‚           â”œâ”€ Avatar/Initials
                          â”‚   â”‚           â”œâ”€ User Info
                          â”‚   â”‚           â”œâ”€ Role Badge
                          â”‚   â”‚           â”œâ”€ Status Badge
                          â”‚   â”‚           â””â”€ Actions Dropdown
                          â”‚   â”‚               â”œâ”€ Edit
                          â”‚   â”‚               â”œâ”€ Reset Password
                          â”‚   â”‚               â””â”€ Enable/Disable
                          â”‚   â””â”€ Pagination
                          â”œâ”€ CreateUserDialog
                          â”‚   â””â”€ Form (React Hook Form + Zod)
                          â”œâ”€ EditUserDialog
                          â”‚   â””â”€ Form (React Hook Form + Zod)
                          â””â”€ ResetPasswordDialog
                              â””â”€ Form (React Hook Form + Zod)
```

## Technology Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FRONTEND STACK                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ React 18                  - UI library                    â”‚
â”‚  â€¢ TypeScript                - Type safety                   â”‚
â”‚  â€¢ Vite                      - Build tool                    â”‚
â”‚  â€¢ TanStack Query            - Data fetching & caching       â”‚
â”‚  â€¢ TanStack Table            - Table component               â”‚
â”‚  â€¢ React Hook Form           - Form management               â”‚
â”‚  â€¢ Zod                       - Validation                    â”‚
â”‚  â€¢ Tailwind CSS              - Styling                       â”‚
â”‚  â€¢ Radix UI                  - Headless components           â”‚
â”‚  â€¢ Framer Motion             - Animations                    â”‚
â”‚  â€¢ Lucide React              - Icons                         â”‚
â”‚  â€¢ date-fns                  - Date formatting               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      BACKEND STACK                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ Node.js                   - Runtime                       â”‚
â”‚  â€¢ Express                   - Web framework                 â”‚
â”‚  â€¢ TypeScript                - Type safety                   â”‚
â”‚  â€¢ Prisma                    - ORM                           â”‚
â”‚  â€¢ PostgreSQL                - Database                      â”‚
â”‚  â€¢ bcryptjs                  - Password hashing              â”‚
â”‚  â€¢ jsonwebtoken              - JWT tokens                    â”‚
â”‚  â€¢ Zod                       - Validation                    â”‚
â”‚  â€¢ Helmet                    - Security headers              â”‚
â”‚  â€¢ CORS                      - Cross-origin                  â”‚
â”‚  â€¢ express-rate-limit        - Rate limiting                 â”‚
â”‚  â€¢ cookie-parser             - Cookie handling               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**Architecture Version:** 1.0.0  
**Last Updated:** February 1, 2026
